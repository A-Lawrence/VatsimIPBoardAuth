<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Vatsimipboardauth by A-Lawrence</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Vatsimipboardauth</h1>
      <h2 class="project-tagline">ipBoard SSO integration.</h2>
      <a href="https://github.com/A-Lawrence/VatsimIPBoardAuth" class="btn">View on GitHub</a>
      <a href="https://github.com/A-Lawrence/VatsimIPBoardAuth/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/A-Lawrence/VatsimIPBoardAuth/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="vatsimipboardauth" class="anchor" href="#vatsimipboardauth" aria-hidden="true"><span class="octicon octicon-link"></span></a>VatsimIPBoardAuth</h1>

<h1></h1>

<p>Anthony Lawrence <a href="mailto:freelancer@anthonylawrence.me.uk">freelancer@anthonylawrence.me.uk</a></p>

<p>An IPBoard 4 login handler for Cert's SSO.  For IPBoard 3.4.x, look in the other branch. This does <em>not</em> modify logins to the admin area.</p>

<h2>
<a id="some-important-notes-for-those-adding-this-to-an-existing-board" class="anchor" href="#some-important-notes-for-those-adding-this-to-an-existing-board" aria-hidden="true"><span class="octicon octicon-link"></span></a>Some Important Notes (For those adding this to an existing board)</h2>

<p>The installation steps below work on the premise that this is a <em>fresh</em> installation of IPBoard.  If you wish to introduce this to an <em>existing</em> V4 board, then there are some additional steps.</p>

<p>AFTER you've completed the installation, you should populate the vatsim_cid field with the current CID's of your membership <em>if you have them</em>.
If you do not have this data, the best suggestion would be for members to be treated as "new members" and then have administrators merge those accounts when people request it.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<ul>
<li>Take a backup.  Please!</li>
<li>Clone this repository somewhere.</li>
<li>Run git submodule update --init --recursive to download the demo code.</li>
<li>Copy all files into system/Login</li>
<li>Run the following MySQL Commands to add this login handler to your installation, add a vatsim_cid field to the members table and then adds some needed entries to your languages table (English only). <em><em>make sure that you edit the queries to match your IPBoard prefix if it isn't default</em></em>.</li>
</ul>

<pre><code>INSERT INTO `ibf_core_login_handlers` (`login_key`, `login_settings`, `login_order`, `login_acp`, `login_enabled`) VALUES ('Vatsim', '{"sso_base":null,"sso_key":null,"sso_secret":null,"sso_rsa_key":null}', '1', '0', '1');
ALTER TABLE `ibf_core_members` ADD `vatsim_cid` INT(7) UNSIGNED NULL AFTER `member_id`;
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_handler_Vatsim', 'VATSIM SSO Login', NULL, '100031', NULL, '0', '1', NULL, NULL);
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_vatsim_sso_base', 'VATSIM SSO Base URL', NULL, '100031', NULL, '0', '1', NULL, NULL);
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_vatsim_sso_key', 'Your SSO Key', NULL, '100031', NULL, '0', '1', NULL, NULL);
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_vatsim_sso_secret', 'Your SSO Secret', NULL, '100031', NULL, '0', '1', NULL, NULL);
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_vatsim_sso_rsa_key', 'Your RSA Key', NULL, '100031', NULL, '0', '1', NULL, NULL);
INSERT INTO `ibf_core_sys_lang_words` (`word_id`, `lang_id`, `word_app`, `word_key`, `word_default`, `word_custom`, `word_default_version`, `word_custom_version`, `word_js`, `word_export`, `word_plugin`, `word_theme`) VALUES (NULL, '1', 'core', 'login_vatsim_cancelled', 'You cancelled your login.', NULL, '100031', NULL, '0', '1', NULL, NULL);
</code></pre>

<ul>
<li>Login to your Admin Control Panel, visit System &gt; Settings &gt; Login Handlers</li>
<li>Edit the Vatsim Login Handler and complete the form with the details requested.  You can get these from the VATSIM SSO website once you've registered as an SSO consumer.</li>
<li>Visit Customisation &gt; Themes and click "Edit HTML/CSS" for the default theme (you'll have to figure out these steps for any custom/purchased templates)</li>
<li>Locate loginPopup in the global section and modify it to match: <a href="https://gist.github.com/A-Lawrence/d0fe1ffcf13c15e1926d">https://gist.github.com/A-Lawrence/d0fe1ffcf13c15e1926d</a> (What we're achiving here is disabling the normal login for users)</li>
<li>Locate login in the system section and modify it to match: <a href="https://gist.github.com/A-Lawrence/135238e6aff855fcb571">https://gist.github.com/A-Lawrence/135238e6aff855fcb571</a> (We're also disabling normal login from the standard login screen)</li>
<li>Save those templates (your forum may lose it's styling momentarily whils the style caches are rebuilt)</li>
<li>That's it! Go and use it.</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/A-Lawrence/VatsimIPBoardAuth">Vatsimipboardauth</a> is maintained by <a href="https://github.com/A-Lawrence">A-Lawrence</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-53881253-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

